16/11/05 16:56:33 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
16/11/05 16:56:34 WARN SparkContext: Use an existing SparkContext, some configuration may not take effect.
Initializing the the KMeans model...
Materializing Twitter stream...
Exception in thread "main" org.apache.spark.SparkException: Task not serializable
	at org.apache.spark.util.ClosureCleaner$.ensureSerializable(ClosureCleaner.scala:298)
	at org.apache.spark.util.ClosureCleaner$.org$apache$spark$util$ClosureCleaner$$clean(ClosureCleaner.scala:288)
	at org.apache.spark.util.ClosureCleaner$.clean(ClosureCleaner.scala:108)
	at org.apache.spark.SparkContext.clean(SparkContext.scala:2056)
	at org.apache.spark.streaming.dstream.DStream$$anonfun$filter$1.apply(DStream.scala:559)
	at org.apache.spark.streaming.dstream.DStream$$anonfun$filter$1.apply(DStream.scala:559)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)
	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)
	at org.apache.spark.SparkContext.withScope(SparkContext.scala:679)
	at org.apache.spark.streaming.StreamingContext.withScope(StreamingContext.scala:264)
	at org.apache.spark.streaming.dstream.DStream.filter(DStream.scala:558)
	at com.databricks.apps.twitterClassifier.Predict.examineAndTrain(Predict.scala:42)
	at com.databricks.apps.twitterClassifier.Predict$.delayedEndpoint$com$databricks$apps$twitterClassifier$Predict$1(Predict.scala:28)
	at com.databricks.apps.twitterClassifier.Predict$delayedInit$body.apply(Predict.scala:11)
	at scala.Function0$class.apply$mcV$sp(Function0.scala:34)
	at scala.runtime.AbstractFunction0.apply$mcV$sp(AbstractFunction0.scala:12)
	at scala.App$$anonfun$main$1.apply(App.scala:76)
	at scala.App$$anonfun$main$1.apply(App.scala:76)
	at scala.collection.immutable.List.foreach(List.scala:381)
	at scala.collection.generic.TraversableForwarder$class.foreach(TraversableForwarder.scala:35)
	at scala.App$class.main(App.scala:76)
	at com.databricks.apps.twitterClassifier.Predict$.main(Predict.scala:11)
	at com.databricks.apps.twitterClassifier.Predict.main(Predict.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.SparkSubmit$.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:736)
	at org.apache.spark.deploy.SparkSubmit$.doRunMain$1(SparkSubmit.scala:185)
	at org.apache.spark.deploy.SparkSubmit$.submit(SparkSubmit.scala:210)
	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:124)
	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
Caused by: java.io.NotSerializableException: org.apache.spark.SparkContext
Serialization stack:
	- object not serializable (class: org.apache.spark.SparkContext, value: org.apache.spark.SparkContext@58f437b0)
	- field (class: com.databricks.apps.twitterClassifier.Predict, name: sparkContext, type: class org.apache.spark.SparkContext)
	- object (class com.databricks.apps.twitterClassifier.Predict, com.databricks.apps.twitterClassifier.Predict@1f03fba0)
	- field (class: com.databricks.apps.twitterClassifier.Predict$$anonfun$examineAndTrain$2, name: $outer, type: class com.databricks.apps.twitterClassifier.Predict)
	- object (class com.databricks.apps.twitterClassifier.Predict$$anonfun$examineAndTrain$2, <function1>)
	at org.apache.spark.serializer.SerializationDebugger$.improveException(SerializationDebugger.scala:40)
	at org.apache.spark.serializer.JavaSerializationStream.writeObject(JavaSerializer.scala:46)
	at org.apache.spark.serializer.JavaSerializerInstance.serialize(JavaSerializer.scala:100)
	at org.apache.spark.util.ClosureCleaner$.ensureSerializable(ClosureCleaner.scala:295)
	... 31 more
